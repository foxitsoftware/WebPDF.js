function getFileFromURL(t,a){var e=new XMLHttpRequest,o=t.indexOf("blob")?"blob":"arraybuffer";e.open("GET",t,!0);e.responseType=o;e.addEventListener("load",function(t){var e=(this.getResponseHeader("Last-Modified"),this.response),o=(e.size,new FileReader);o.readAsArrayBuffer(e);o.onload=function(t){var e=new Uint8Array(t.target.result);a&&a(e)}},!1);e.addEventListener("error",function(){},!1);e.send()}function GetFontBuffer(t){var a=new XMLHttpRequest,e=UTF8ToString(t);a.open("get",baseFontUrl+e,!1);a.responseType="arraybuffer";try{a.send()}catch(o){m_FontSize=0;return null}var n=a.response,r=new Uint8Array(n);r=brotli.decompress(r,null);var l=Module._malloc(r.length*r.BYTES_PER_ELEMENT);Module.HEAPU8.set(r,l);m_FontSize=r.length;return l}function GetFontBufferSize(){return m_FontSize}function GetFontFileName_bak(t){var a=new XMLHttpRequest,e=UTF8ToString(t),o=encodeURI(e);a.open("GET","http://218.5.9.250:20080/?id="+o,!1);a.send();var n=Module._malloc(a.responseText.length+1);writeStringToMemory(a.responseText,n);return n}function adjustFontName(t){t=t.replace(/-/g,"");t=t.replace(/\s/g,"");t=t.toLowerCase();return t}function isMatchFontName(t,a){if(null==t||null==a)return!1;for(var e=a.split("_"),o=0;o<e.length;o++)if(-1!=t.indexOf(e[o]))return!0;return!1}function matchFixedPitch(t,a,e){var o=null;if(1&a){void 0!=fontMap[e].monoRegular&&null!=fontMap[e].monoRegular&&(o=fontMap[e].monoRegular);(16384&a||-1!=t.indexOf("bold")||-1!=t.indexOf("heavy"))&&(void 0==fontMap[e].monoBold&&""==fontMap[e].monoBold||(o=fontMap[e].monoBold))}return o}function matchSerif(t,a,e){var o=null;if(2&a){void 0!=fontMap[e].serif&&null!=fontMap[e].serif&&(o=fontMap[e].serif);(16384&a||-1!=t.indexOf("bold")||-1!=t.indexOf("heavy"))&&(void 0==fontMap[e].serifBold&&""==fontMap[e].serifBold||(o=fontMap[e].serifBold))}return o}function matchWeight(t,a){var e=null;switch(t){case 100:void 0!=fontMap[a].thin&&null!=fontMap[a].thin&&(e=fontMap[a].thin);break;case 200:void 0!=fontMap[a].light&&null!=fontMap[a].light&&(e=fontMap[a].light);break;case 300:void 0!=fontMap[a].normal&&null!=fontMap[a].normal&&(e=fontMap[a].normal);break;case 400:break;case 500:break;case 700:void 0!=fontMap[a].bold&&null!=fontMap[a].bold&&(e=fontMap[a].bold);break;case 900:void 0!=fontMap[a].black&&null!=fontMap[a].black&&(e=fontMap[a].black)}return e}function matchBold(t,a,e){var o=null;(16384&a||-1!=t.indexOf("bold")||-1!=t.indexOf("heavy")||-1!=t.indexOf("black"))&&(void 0==fontMap[e].bold&&""==fontMap[e].bold||(o=fontMap[e].bold));return o}function GetFontFileName(t,a,e,o,n){var r=UTF8ToString(t);r=adjustFontName(r);if(null==r||""==r)return null;for(var l="",i=255&a,s=0;s<fontMap.length;s++){var c=isMatchFontName(r,fontMap[s].fontName);if(c||fontMap[s].charSet==i){if(0==i&&0==c)continue;l=matchSerif(r,n,s);if(null!=l)break;l=matchFixedPitch(r,n,s);if(null!=l)break;void 0!=fontMap[s].regular&&null!=fontMap[s].regular&&(l=fontMap[s].regular);var f=matchWeight(o,s);null!=f&&(l=f);f=matchBold(r,n,s);null!=f&&(l=f);break}}if(""!=l&&null!=l){var d=Module._malloc(l.length+1);writeStringToMemory(l,d);return d}return null}function PrintData(t){var a=UTF8ToString(t);Module.print("PrintData:"+a)}var Module={TOTAL_MEMORY:134217728};importScripts("./lib/FXJS_rel.js");importScripts("./lib/brotli.js");var m_pModuleMgrCommon=null,m_pPDFFileBuffer=null,m_pPDFFilelength=null,m_pPDFDoc=null,m_pPDFMrg=null,handleArr=[],m_passWordChnageId=null,keyObject=Object.create(null);!function(){var t=new XMLHttpRequest;t.open("GET","./lib/key.txt?v="+Math.random(),!1);t.responseType="text";try{t.send()}catch(a){}if(200==t.status){var e=t.responseText;if(""!=e)for(var o=e.split("\r\n"),n=0;n<o.length;n++){var r=o[n],l=r.split("=");l.length>1&&(keyObject[l[0]]=l[1])}}}();var PDFParseCode={PDFPARSE_ERROR_SUCCESS:0,PDFPARSE_ERROR_FILE:1,PDFPARSE_ERROR_FORMAT:2,PDFPARSE_ERROR_PASSWORD:3,PDFPARSE_ERROR_HANDLER:4,PDFPARSE_ERROR_CERT:5},msgTest={type:"test",typefn:function(t){postMessage({action:"test",targetName:"main",data:{supportTypedArray:1,supportTransfers:1}})}},UpdatePassword={type:"UpdatePassword",typefn:function(t){var a=function(t){t==PDFParseCode.PDFPARSE_ERROR_PASSWORD&&postMessage({targetName:"main",action:"IncorrectPassword",data:{error:1}})},e=Module._malloc(4);m_pPDFDoc=m_pPDFMrg.LoadDocument(m_pPDFFileBuffer,m_pPDFFilelength,t.data.data,e);var o=HEAP32[e>>2];if(0==o){var n=m_pPDFDoc.GetPdfInfo();n=JSON.parse(n);postMessage({action:"GetDoc",targetName:"main",data:{pdfInfo:n}});postMessage({action:"DataLoaded",targetName:"main",data:{length:m_pPDFFilelength}});Module._free(e)}else{a(o);m_pPDFDoc=null;Module._free(e)}}},GetDocRequest={type:"GetDocRequest",typefn:function(t){if(null==m_pPDFMrg){m_pPDFMrg=new Module.FXJS_PDFMrg;var a=!1;if(null!=keyObject){null==keyObject.ExpireDate&&(keyObject.ExpireDate="");a=m_pPDFMrg.verifyLicenseInfo(keyObject.SN,keyObject.Modules,keyObject.Users,keyObject.Licensee,keyObject.ExpireDate,keyObject.LicenseDate,keyObject.Restrictions,keyObject.Sign)}if(0==a){postMessage({action:"GetDocResponse",isReply:1,targetName:"main",data:"main",callbackId:t.data.callbackId});postMessage({targetName:"main",action:"InvalidKey",data:{error:2}});return}}var e=function(a){postMessage({action:"GetDocResponse",isReply:1,targetName:"main",data:"main",callbackId:t.data.callbackId});if(a==PDFParseCode.PDFPARSE_ERROR_PASSWORD){m_passWordChnageId=t.data.callbackId;postMessage({targetName:"main",action:"NeedPassword",data:{error:1}})}else if(a==PDFParseCode.PDFPARSE_ERROR_FORMAT){m_passWordChnageId=t.data.callbackId;postMessage({targetName:"main",action:"InvalidPDF",data:{error:2}})}else postMessage({targetName:"main",action:"UnexpectedResponse",data:{error:2}})},o=function(a){m_pPDFFileBuffer=Module._malloc(a.length*a.BYTES_PER_ELEMENT);Module.HEAPU8.set(a,m_pPDFFileBuffer);var o=Module._malloc(4);m_pPDFDoc=m_pPDFMrg.LoadDocument(m_pPDFFileBuffer,a.length*a.BYTES_PER_ELEMENT,"",o);m_pPDFFilelength=a.length*a.BYTES_PER_ELEMENT;var n=HEAP32[o>>2];if(0==n){postMessage({action:"GetDocResponse",isReply:1,targetName:"main",data:"main",callbackId:t.data.callbackId});postMessage({action:"DataLoaded",targetName:"main",data:{length:a.length*a.BYTES_PER_ELEMENT}});Module._free(o)}else{e(n);m_pPDFDoc=null;Module._free(o)}};t.data.data.source.data?o(t.data.data.source.data):t.data.data.source.url&&getFileFromURL(t.data.data.source.url,function(t){o(t)})}},Ready={type:"Ready",typefn:function(t){var a=null;if(m_pPDFDoc){a=m_pPDFDoc.GetPdfInfo();a=JSON.parse(a)}postMessage({action:"GetDoc",targetName:"main",data:{pdfInfo:a}})}},GetPage={type:"GetPage",typefn:function(t){if(m_pPDFDoc){var a=t.data.data.pageIndex,e=m_pPDFDoc.GetPage(a);if(e){var o=Module._malloc(4),n=e.GetPageBox(o),r=HEAP32[o>>2];if(0==r){var l=JSON.parse(n);postMessage({action:"GetPageResponse",isReply:1,targetName:"main",data:l,callbackId:t.data.callbackId});Module._free(o)}else Module._free(o)}}}},RenderPageRequest={type:"RenderPageRequest",typefn:function(t){if(m_pPDFDoc){var a=t.data.data.pageIndex,e=t.data.data.width,o=t.data.data.height,n=0;switch(t.data.data.rotation){case 90:n=1;break;case 180:n=2;break;case 270:n=3;break;case 0:case 360:}var r=m_pPDFDoc.GetPage(a);if(r){var l=Module._malloc(4),i=Module._malloc(4),s=r.GetImage(e,o,n,!0,l,i),c=HEAP32[i>>2];if(0==c){for(var f=HEAPU32[l>>2],d=new Uint8Array(f*o),u=0,m=0;o>m;++m)for(var p=s+f*m,g=0;e>g;++g){d[u++]=HEAPU8[p+2];d[u++]=HEAPU8[p+1];d[u++]=HEAPU8[p];d[u++]=HEAPU8[p+3];p+=4}postMessage({action:"GetImageData",targetName:"main",data:{pageIndex:a,imgArray:d.buffer,intent:t.data.data.intent,renderTaskIndex:t.data.data.renderTaskIndex}},[d.buffer]);Module._free(l);Module._free(i)}else{Module._free(i);Module._free(l)}}}}},GetTextContent={type:"GetTextContent",typefn:function(t){if(m_pPDFDoc){var a=m_pPDFDoc.GetPage(t.data.data.pageIndex);if(a){var e=Module._malloc(4),o=a.GetTextContent(e),n=HEAP32[e>>2];0!=n&&(o='{"items":[],"styles":{}}');var r=JSON.parse(o);postMessage({action:"GetTextContentResponse",isReply:1,targetName:"main",data:r,callbackId:t.data.callbackId});Module._free(e)}}}},GetData={type:"GetData",typefn:function(t){var a,e=Module._malloc(4),o=m_pPDFDoc.getDocumentStream(e);a=HEAPU32[e>>2];for(var n=new Uint8Array(a),r=0;a>r;r++)n[r]=HEAPU8[o++];postMessage({action:"GetDataResponse",isReply:1,targetName:"main",data:n,callbackId:t.data.callbackId});Module._free(e)}},GetAnnotations={type:"GetAnnotations",typefn:function(t){if(m_pPDFDoc){for(var a=m_pPDFDoc.GetPage(t.data.data.pageIndex),e=Module._malloc(4),o=a.GetAnnot(e),n=JSON.parse(o),r=Module._malloc(4),e=Module._malloc(4),l=0;l<n.length;l++){var i=n[l];if("FileAttachment"==i.subtype){var s=i.file,c=(s.content,m_pPDFDoc.GetFileAttacmentBuffer(s.content,r,e)),f=HEAP32[e>>2],d=HEAP32[r>>2];if(0==f)if(0==d)s.content=new Uint8Array(0);else{for(var u=new Uint8Array(d),l=0;d>l;l++)u[l]=HEAPU8[c+l];s.content=u}else s.content=new Uint8Array(0)}}postMessage({action:"GetAnnotationsResponse",isReply:1,targetName:"main",data:n,callbackId:t.data.callbackId});Module._free(e);Module._free(r)}}},GetMetadata={type:"GetMetadata",typefn:function(t){var a={};if(m_pPDFDoc){var e=m_pPDFDoc.GetDocProperty();a=JSON.parse(e);if(m_pPDFMrg){var o=m_pPDFMrg.GetDocVersion();a.PDFFormatVersion=o}}postMessage({action:"GetMetadataResponse",isReply:1,targetName:"main",data:[a,""],callbackId:t.data.callbackId})}},GetAttachments={type:"GetAttachments",typefn:function(t){var a={};if(m_pPDFDoc){var e=m_pPDFDoc.GetFileAttacmentInfo();if(""!==e){a=JSON.parse(e);for(var o=Object.keys(a),n=Module._malloc(4),r=Module._malloc(4),l=0;l<o.length;l++){var i=a[o[l]],s=m_pPDFDoc.GetFileAttacmentBuffer(i.content,n,r),c=HEAP32[r>>2],f=HEAP32[n>>2];if(0==c)if(0==f)i.content=new Uint8Array(0);else{for(var d=new Uint8Array(f),l=0;f>l;l++)d[l]=HEAPU8[s+l];i.content=d}else i.content=new Uint8Array(0)}}}postMessage({action:"GetAttachmentsResponse",isReply:1,targetName:"main",data:a,callbackId:t.data.callbackId});Module._free(r);Module._free(n)}},GetOutline={type:"GetOutline",typefn:function(t){var a=null;if(m_pPDFDoc){var e=m_pPDFDoc.GetBookMarkInfo();a=JSON.parse(e)}postMessage({action:"GetOutlineResponse",isReply:1,targetName:"main",data:a,callbackId:t.data.callbackId})}},Terminate={type:"Terminate",typefn:function(t){if(m_pPDFFileBuffer){Module._free(m_pPDFFileBuffer);m_pPDFFileBuffer=null}if(m_pPDFMrg){m_pPDFMrg.CloseDocument(m_pPDFDoc);Module._free(m_pPDFMrg);m_pPDFMrg=null}m_pPDFDoc=null;postMessage({action:"TerminateResponse",isReply:1,targetName:"main",callbackId:t.data.callbackId})}};handleArr.push(msgTest,GetDocRequest,Ready,GetPage,RenderPageRequest,GetTextContent,GetAnnotations,GetMetadata,GetAttachments,GetOutline,GetData,UpdatePassword,Terminate);onmessage=function(t){handleArr.forEach(function(a,e){t.data.action===a.type&&a.typefn(t)})};var baseFontUrl="http://fonts.foxitsoftware.cn/webfonts/",fontMap=[{fontName:"franklin",charSet:0,bold:"NotoSans-Bold.ttf.brotli",boldItalic:"NotoSans-BoldItalic.ttf.brotli"},{fontName:"youyuan_simhei_simsun_song_仿宋_黑体_宋体",charSet:-1,regular:"NotoSansMonoCJKsc-Regular.otf.brotli",bold:"NotoSansMonoCJKsc-Bold.otf.brotli"},{fontName:"meiryo_meiryoui_msgothic_msmincho_mspgothic_mspmincho_uigothic",charSet:128,regular:"NotoSansCJKjp-Regular.otf.brotli",thin:"NotoSansCJKjp-Thin.otf.brotli",light:"NotoSansCJKjp-Light.otf.brotli",normal:"NotoSansCJKjp-DemiLight.otf.brotli",medium:"NotoSansCJKjp-Medium.otf.brotli",bold:"NotoSansCJKjp-Bold.otf.brotli",black:"NotoSansCJKjp-Black.otf.brotli",monoRegular:"NotoSansMonoCJKjp-Regular.otf.brotli",monoBold:"NotoSansMonoCJKjp-Bold.otf.brotli"},{fontName:"Korean",charSet:129,regular:"NotoSansCJKkr-Regular.otf.brotli",thin:"NotoSansCJKkr-Thin.otf.brotli",light:"NotoSansCJKkr-Light.otf.brotli",normal:"NotoSansCJKkr-DemiLight.otf.brotli",medium:"NotoSansCJKkr-Medium.otf.brotli",bold:"NotoSansCJKkr-Bold.otf.brotli",black:"NotoSansCJKkr-Black.otf.brotli",monoRegular:"NotoSansMonoCJKkr-Regular.otf.brotli",monoBold:"NotoSansMonoCJKkr-Bold.otf.brotli"},{fontName:"simhei_simsun_simsunextb_方正_仿宋_黑体_华文_楷体_隶书_宋体_微软雅黑_新宋体_幼圆",charSet:134,regular:"NotoSansCJKsc-Regular.otf.brotli",thin:"NotoSansCJKsc-Thin.otf.brotli",light:"NotoSansCJKsc-Light.otf.brotli",normal:"NotoSansCJKsc-DemiLight.otf.brotli",medium:"NotoSansCJKsc-Medium.otf.brotli",bold:"NotoSansCJKsc-Bold.otf.brotli",black:"NotoSansCJKsc-Black.otf.brotli",monoRegular:"NotoSansMonoCJKsc-Regular.otf.brotli",monoBold:"NotoSansMonoCJKsc-Bold.otf.brotli"},{fontName:"dfkaisb_microsoftjhenghei_mingliu_mingliuhkscs_mingliuhkscsextb_mingliuextb_pmingliu_pmingliuextb",charSet:136,regular:"NotoSansMonoCJKtc-Regular.otf.brotli",thin:"NotoSansCJKtc-Thin.otf.brotli",light:"NotoSansCJKtc-Light.otf.brotli",normal:"NotoSansCJKtc-DemiLight.otf.brotli",medium:"NotoSansCJKtc-Medium.otf.brotli",bold:"NotoSansCJKtc-Bold.otf.brotli",black:"NotoSansCJKtc-Black.otf.brotli",monoRegular:"NotoSansMonoCJKtc-Regular.otf.brotli",monoBold:"NotoSansMonoCJKtc-Bold.otf.brotli"},{fontName:"arabic_andalus_arabictypesetting_sakkalmajalla_simplifiedarabic_simplifiedarabicfixed_traditionalarabic",charSet:178,regular:"NotoNaskhArabic-Regular.ttf.brotli",bold:"NotoNaskhArabic-Bold.ttf.brotli"},{fontName:"angsananew_angsanaupc_browallianew_browalliaupc_cordianew_cordiaupc_eucrosiaupc_freesiaupc_irisupc_jasmineupc_kodchiangupc_leelawadee_lilyupc",charSet:222,regular:"NotoSansThai-Regular.ttf.brotli",bold:"NotoSansThai-Bold.ttf.brotli",serif:"NotoSerifThai-Regular.ttf.brotli",serifBold:"NotoSerifThai-Bold.ttf.brotli"},{fontName:"aharoni_david_frankruehl_gisha_levenimmt_miriam_narkism_rod",charSet:-1,regular:"NotoSansHebrew-Regular.ttf.brotli",bold:"NotoSansHebrew-Bold.ttf.brotli"},{fontName:"arial_sylfaen_tahoma_couriernew_lucidasansunicode_timesnewroman_calibri_cambria_candara_comicsansms_consolas_constantia_corbel_franklingothic_gabriola_georgia_impact_lucidaconsole_microsoftsansserif_msrefrencesansserif_palatinolinotype_segoeprint_segoescript_segoeui_trebuchetms_verdana_helvetica",charSet:-1,regular:"NotoSans-Regular.ttf.brotli",bold:"NotoSans-Bold.ttf.brotli"},{fontName:"yi_microsoftyibati",charSet:-1,regular:"NotoSansYi-Regular.ttf.brotli"},{fontName:"daunpenh_khmer_moolboran",charSet:-1,regular:"NotoSansKhmer-Regular.ttf.brotli",bold:"NotoSansKhmer-Bold.ttf.brotli",serif:"NotoSerifKhmer-Regular.ttf.brotli",serifBold:"NotoSerifKhmer-Bold.ttf.brotli"},{fontName:"dokchampa_lao",charSet:-1,regular:"NotoSansLao-Regular.ttf.brotli",bold:"NotoSansLao-Bold.ttf.brotli",serif:"NotoSerifLao-Regular.ttf.brotli",serifBold:"NotoSerifLao-Bold.ttf.brotli"},{fontName:"vani_gautami",charSet:-1,regular:"NotoSansTelugu-Regular.ttf.brotli",bold:"NotoSansTelugu-Bold.ttf.brotli"},{fontName:"latha_vijaya",charSet:-1,regular:"NotoSansTamil-Regular.ttf.brotli",bold:"NotoSansTamil-Bold.ttf.brotli"},{fontName:"moboli_mvboli",charSet:-1,regular:"NotoSansThaana-Regular.ttf.brotli",bold:"NotoSansThaana-Bold.ttf.brotli"},{fontName:"taile_microsofttaile",charSet:-1,regular:"NotoSansTaiLe-Regular.ttf.brotli"},{fontName:"estrangeloedessa",charSet:-1,regular:"NotoSansSyriacEastern-Regular.ttf.brotli"},{fontName:"iskoolapota",charSet:-1,regular:"NotoSansSinhala-Regular.ttf.brotli",bold:"NotoSansSinhala-Bold.ttf.brotli"},{fontName:"himalaya_microsofthimalaya",charSet:-1,regular:"NotoSansTibetan-Regular.ttf.brotli",bold:"NotoSansTibetan-Bold.ttf.brotli"},{fontName:"phagspa_microsoftphagspa",charSet:-1,regular:"NotoSansPhagsPa-Regular.ttf.brotli"},{fontName:"euphemia_gadugi",charSet:-1,regular:"NotoSansCanadianAboriginal-Regular.ttf.brotli"},{fontName:"plantagenetcherokee",charSet:-1,regular:"NotoSansCherokee-Regular.ttf.brotli"},{fontName:"nyala_ebrima",charSet:-1,regular:"NotoSansEthiopic-Regular.ttf.brotli",bold:"NotoSansEthiopic-Bold.ttf.brotli"},{fontName:"shruti",charSet:-1,regular:"NotoSansGujarati-Regular.ttf.brotli",bold:"NotoSansGujarati-Bold.ttf.brotli"},{fontName:"mongolian_mongolianbaiti",charSet:-1,regular:"NotoSansMongolian-Regular.ttf.brotli"},{fontName:"nirmalaui",charSet:-1,regular:"NotoNirmalaui-Regular.ttf.brotli"}];